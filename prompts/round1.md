# Project Goal

To create a simple, view-only static website, deployed on Vercel, that displays a list of transactions and the current balance for a child's "bank account". Data updates are performed offline using a Python command-line tool that modifies a CSV file stored in the project's Git repository. Pushing the updated CSV triggers an automatic rebuild and deployment on Vercel via Hugo.

## Core Workflow

1.  **Initialization:** A Hugo project is set up with a specific data file (`data/transactions.csv`) and a layout template designed to display its contents. The project is hosted in a Git repository (e.g., GitHub).
2.  **Data Update:** The parent runs a Python script (`manage_bank.py`) locally, providing transaction details (description, amount) via command-line arguments.
3.  **Script Execution:** The Python script reads the current `transactions.csv`, calculates the new running balance based on the last entry, appends the new transaction details (timestamp, description, amount, new balance) as a new row to the CSV file.
4.  **Commit & Push:** The parent commits the modified `transactions.csv` file to the Git repository and pushes it.
5.  **Vercel Trigger:** Vercel automatically detects the push to the connected Git repository.
6.  **Vercel Build:** Vercel checks out the latest code and runs the Hugo build process (`hugo` command).
7.  **Hugo Processing:** Hugo identifies the `transactions.csv` file within its `data` directory. The predefined Hugo layout (`layouts/_default/list.html`) accesses this data using `site.Data.transactions`. Hugo's templating engine iterates through the CSV rows and renders an HTML page displaying the transaction history and the final balance.
8.  **Vercel Deployment:** Vercel deploys the generated static HTML, CSS, and JavaScript files to its global CDN.
9.  **Viewing:** The child (or parent) navigates to the Vercel URL (e.g., `https://kids-bank.[your-vercel-domain].app/transactions/`) to view the up-to-date transaction list and balance.

## Technology Stack

* **Static Site Generator:** Hugo (latest stable version recommended)
* **Data Storage:** CSV file (`transactions.csv`)
* **Update Tool:** Python 3 (using only standard libraries: `csv`, `datetime`, `argparse`)
* **Version Control:** Git
* **Hosting/Deployment:** Vercel (Free Tier)

## Key Requirements & Constraints

* **No Runtime Database:** The live website must be purely static HTML/CSS/JS. Data is baked in at build time.
* **Offline Updates Only:** Data modification happens exclusively through the local Python CLI tool and Git commits.
* **Implicit Authorization:** The ability to commit and push to the specific Git repository branch is the sole authorization mechanism.
* **Chronological Order:** Transactions should be displayed chronologically, ideally based on the order they appear in the CSV (which the Python script ensures by appending).
* **Running Balance:** Each transaction row in the output must show the balance *after* that transaction occurred. The final, current balance must also be clearly displayed.
* **Simplicity:** Minimize the number of files, dependencies, and complex configurations. Avoid JavaScript for core functionality if possible (display logic handled by Hugo templates).

## Detailed File Specifications

### 1. File: `data/transactions.csv`

* **Purpose:** Serves as the single, persistent source of truth for all transaction data.
* **Location:** Must be placed in the `data/` directory at the root of the Hugo project. Create the `data` directory if it doesn't exist.
* **Format:** UTF-8 encoded Comma Separated Values (CSV).
* **Header Row (Required):** The first line must be the header row. Hugo uses this to map column names to data fields. Header names should be simple and valid as variable names in Go Templates (alphanumeric, underscores okay, avoid spaces or special characters). Suggested headers:
    ```csv
    Date,Description,Amount,Balance
    ```
* **Data Rows:** Each subsequent row represents a single transaction.
    * **Date:** An ISO 8601 formatted timestamp (e.g., `2025-03-26T13:52:00Z` or `2025-03-26`). Consistency is key. Generated by the Python script.
    * **Description:** A brief text description of the transaction (e.g., "Allowance", "Spent on candy", "Birthday gift"). Should be enclosed in double quotes if it contains commas.
    * **Amount:** A numerical value representing the transaction amount. Use positive numbers for deposits/credits and negative numbers for withdrawals/debits (e.g., `5.00`, `-1.50`).
    * **Balance:** A numerical value representing the account balance *after* the current transaction was applied. This is calculated and written by the Python script.
* **Initial State:** The file must contain the header row. It's recommended to add an initial "zero balance" entry to simplify the Python script's logic for reading the last balance.
    ```csv
    Date,Description,Amount,Balance
    2025-03-26T00:00:00Z,"Initial Balance",0.00,0.00
    ```
    *(Replace the date with the actual creation date/time).*

### 2. File: `manage_bank.py`

* **Purpose:** A command-line utility run locally to safely add new transactions to `transactions.csv`.
* **Location:** Can reside in the project root or a `scripts/` directory. Must be able to locate `data/transactions.csv`.
* **Language/Dependencies:** Python 3, using only standard libraries: `csv`, `datetime`, `argparse`, `os`.
* **Execution:**
    ```bash
    python manage_bank.py --description "Some Transaction" --amount 10.50
    ```
* **Core Logic:**
    * **Argument Parsing (`argparse`):**
        * Define required arguments: `--description` (string) and `--amount` (float). Add help messages.
    * **CSV File Path:** Construct the path to `data/transactions.csv` relative to the script's location or assuming execution from the project root.
    * **Read Last Balance:**
        * Open `transactions.csv` for reading.
        * Read all rows. Handle potential `FileNotFoundError`.
        * Identify the last row (skip header).
        * Extract the value from the 'Balance' column of the last row. Convert it to a float. If only the header exists, the last balance is `0.00`.
    * **Calculate New Balance:** Add the `amount` from the command-line argument to the `last_balance`.
    * **Generate Timestamp:** Get the current date and time using `datetime.datetime.now(datetime.timezone.utc).isoformat()` or a similar method for a consistent, timezone-aware timestamp.
    * **Prepare New Row:** Create a list or dictionary containing the new transaction data: `[new_timestamp, args.description, args.amount, new_balance]`.
    * **Append to CSV (`csv` module):**
        * Open `transactions.csv` in append mode (`'a'`), ensuring `newline=''` to prevent extra blank rows.
        * Create a `csv.writer`.
        * Use `writer.writerow()` to append the `new_row` data.
    * **Confirmation Output:** Print a success message to the console, e.g., `f"Transaction '{args.description}' added. New balance: {new_balance:.2f}"`.
    * **Error Handling:** Include `try...except` blocks for file operations and float conversion of the amount/balance. Provide informative error messages.

### 3. File: `layouts/_default/list.html`

* **Purpose:** Hugo template responsible for rendering pages that display lists of items, specifically adapted here to display the transactions from the CSV.
* **Location:** `layouts/_default/list.html`.
* **Language:** HTML + Go Templates (Hugo's templating language).
* **Core Logic:**
    * **Basic HTML Structure:** Include `<html>`, `<head>` (with `{{ .Title }}`), `<body>`.
    * **Access CSV Data:** Use `{{ $transactions := site.Data.transactions }}` to load the parsed data from `data/transactions.csv` into a variable. Hugo automatically parses CSV into a slice of maps based on the header row.
    * **Display Page Title:** Use `<h1>{{ .Title }}</h1>`.
    * **Render Transaction Table:**
        * Create an HTML `<table>` with a `<thead>` matching the CSV headers (Date, Description, Amount, Balance).
        * Create a `<tbody>`.
        * Use `{{ range $transactions }}` to iterate through each transaction row (map) in the data.
        * Inside the loop, create a `<tr>` for each row.
        * Create `<td>` elements, accessing data using the header keys: `{{ .Date }}`, `{{ .Description }}`, `{{ .Amount }}`, `{{ .Balance }}`.
        * **Formatting:** Use Hugo's `printf` or `FormatCurrency` (if enabled/configured) functions to format the Amount and Balance fields as currency (e.g., `{{ printf "%.2f" .Amount }}`). Consider conditional formatting for amount (e.g., different color for positive/negative).
        * End the loop `{{ end }}`.
    * **Display Current Balance:**
        * After the table, add a section to display the final balance.
        * Access the last element of the `$transactions` slice: `{{ $lastTx := index $transactions (sub (len $transactions) 1) }}`.
        * Display the balance: `<h2>Current Balance: {{ printf "%.2f" $lastTx.Balance }}</h2>`. (Add error handling or checks in case the transaction list is empty, though the initial balance row prevents this).
    * **Optional Styling:** Link to a simple CSS file (`<link rel="stylesheet" href="/css/style.css">`) for basic table and page styling.

### 4. File: `config.toml` (or `hugo.toml`)

* **Purpose:** Main configuration file for the Hugo site.
* **Location:** Project root.
* **Minimal Content (`hugo.toml` syntax):**
    ```toml
    baseURL = "/" # Set to Vercel URL after deployment, "/" works for relative paths
    languageCode = "en-us"
    title = "Kid's Bank Ledger"

    # Optional: Disable kinds you don't need for simplicity
    disableKinds = ["taxonomy", "term", "RSS"]

    # Optional: Configure currency formatting if using FormatCurrency
    # [params.intl]
    #   currency = "USD"
    ```

### 5. File: `content/transactions.md`

* **Purpose:** A content file that instructs Hugo to render a page at the URL `/transactions/` using the `layouts/_default/list.html` template.
* **Location:** `content/transactions.md`.
* **Content:**
    ```yaml
    ---
    title: "Transaction History"
    # layout: "list" # Often not needed if placed directly in content/, Hugo finds _default/list.html
    # draft: false # Ensure it's not a draft
    ---
    ```

### 6. File: `static/css/style.css` (Optional but Recommended)

* **Purpose:** Provide basic styling for readability.
* **Location:** `static/css/style.css`.
* **Content:** Simple CSS rules for table borders, padding, typography, maybe alternating row colors. Example:
    ```css
    body {
        font-family: sans-serif;
        margin: 2em;
    }
    table {
        border-collapse: collapse;
        width: 100%;
        margin-bottom: 1em;
    }
    th, td {
        border: 1px solid #ddd;
        padding: 8px;
        text-align: left;
    }
    th {
        background-color: #f2f2f2;
    }
    tbody tr:nth-child(odd) {
        background-color: #f9f9f9;
    }
    ```